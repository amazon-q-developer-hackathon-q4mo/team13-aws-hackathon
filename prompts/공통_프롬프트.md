# Team13 LiveInsight - 공통 프롬프트

## 프로젝트 개요
**Team13 LiveInsight**는 12시간 Amazon Q Developer 해커톤에서 개발하는 실시간 웹사이트 사용자 행동 분석 서비스입니다.

## 팀 구성
- **개발자 A**: 인프라/백엔드 (AWS Lambda, DynamoDB, API Gateway)
- **개발자 B**: 애플리케이션 (Django REST API, 프론트엔드 대시보드)

## 전체 아키텍처
```
웹사이트 (JS 추적) → API Gateway → Lambda → DynamoDB
                                              ↓
                    프론트엔드 ← Django API ← DynamoDB 조회
```

## 공통 환경 변수 (모든 개발자 필수 준수)
```env
# AWS 설정
AWS_DEFAULT_REGION=us-east-1
AWS_ACCESS_KEY_ID=your-access-key
AWS_SECRET_ACCESS_KEY=your-secret-key

# DynamoDB 테이블
EVENTS_TABLE=LiveInsight-Events
SESSIONS_TABLE=LiveInsight-Sessions
ACTIVE_SESSIONS_TABLE=LiveInsight-ActiveSessions

# API 엔드포인트
API_GATEWAY_URL=YOUR_API_GATEWAY_URL
```

## 데이터 모델 (공통 이해 필수)

### 이벤트 (Event)
```json
{
  "event_id": "evt_20241201_123456_abc123",
  "timestamp": 1701432000000,
  "user_id": "user_abc123", 
  "session_id": "sess_20241201_abc123",
  "event_type": "page_view|click|conversion|heartbeat",
  "page_url": "https://example.com/page",
  "referrer": "https://google.com"
}
```

### 세션 (Session)
```json
{
  "session_id": "sess_20241201_abc123",
  "user_id": "user_abc123",
  "start_time": 1701432000000,
  "last_activity": 1701433800000,
  "is_active": true,
  "entry_page": "/home",
  "exit_page": "/products",
  "total_events": 15,
  "session_duration": 1800
}
```

### 활성 세션 (ActiveSession)
```json
{
  "session_id": "sess_20241201_abc123",
  "user_id": "user_abc123", 
  "last_activity": 1701433800000,
  "current_page": "/products",
  "expires_at": 1701435600
}
```

## API 엔드포인트 규격 (공통 준수)

### 이벤트 수집 API
```
POST /events
Content-Type: application/json

Request Body:
{
  "user_id": "user_123",
  "session_id": "sess_123", // optional
  "event_type": "page_view",
  "page_url": "https://example.com/page",
  "referrer": "https://google.com"
}

Response:
{
  "statusCode": 200,
  "body": {
    "message": "Event processed successfully",
    "event_id": "evt_xxx",
    "session_id": "sess_xxx"
  }
}
```

### 대시보드 API
```
GET /api/sessions/active/           - 활성 세션 목록
GET /api/sessions/{id}/events/      - 세션별 이벤트
GET /api/statistics/hourly/?hours=24 - 시간대별 통계
GET /api/statistics/pages/          - 페이지별 통계
```

## 개발 일정 (12시간)
```
Phase 1 (1시간): 초기 설정
Phase 2 (2시간): 인프라/기본구조 구축  
Phase 3 (4시간): 핵심 기능 개발 (병렬)
Phase 4 (3시간): 대시보드/최적화 (병렬)
Phase 5 (2시간): 테스트 및 배포 (공동)
```

## 의존성 관계
1. **개발자 A Phase 2** → API Gateway URL 생성
2. **API Gateway URL** → **개발자 B Phase 3** (이벤트 추적 스크립트)
3. **개발자 A Phase 2** → DynamoDB 테이블 생성
4. **DynamoDB 테이블** → **개발자 B Phase 3** (Django 연동)

## 소통 체크포인트
- **Phase 2 완료 시**: 개발자 A가 API Gateway URL을 개발자 B에게 전달
- **Phase 3 시작 전**: DynamoDB 테이블 상태 확인
- **Phase 4 시작 전**: API 엔드포인트 테스트 완료
- **Phase 5**: 통합 테스트 및 데모 준비

## 공통 코딩 규칙

### 명명 규칙
- **테이블**: LiveInsight-{TableName}
- **함수**: LiveInsight-{FunctionName}
- **변수**: snake_case (Python), camelCase (JavaScript)

### 에러 처리
```python
# Python
try:
    result = operation()
    return success_response(result)
except Exception as e:
    print(f"Error: {str(e)}")
    return error_response(str(e))
```

```javascript
// JavaScript
try {
    const result = await operation();
    return result;
} catch (error) {
    console.error('Error:', error);
    throw error;
}
```

### CORS 설정 (필수)
```python
# Lambda Response
headers = {
    'Access-Control-Allow-Origin': '*',
    'Access-Control-Allow-Headers': 'Content-Type',
    'Access-Control-Allow-Methods': 'POST,OPTIONS'
}
```

```python
# Django Settings
CORS_ALLOW_ALL_ORIGINS = True
```

## 테스트 전략
1. **단위 테스트**: 각 Phase 완료 시
2. **통합 테스트**: Phase 3 완료 시
3. **시스템 테스트**: Phase 5에서 전체 플로우

## 데모 시나리오
1. **실시간 모니터링**: 활성 세션 목록, 세션 상세 정보
2. **통계 분석**: 시간대별 유입, 페이지별 조회수
3. **기술 아키텍처**: AWS 서버리스 구조 설명

## 문제 해결 가이드
- **API 연결 실패**: CORS 설정 확인
- **DynamoDB 접근 실패**: IAM 권한 확인  
- **Lambda 타임아웃**: 메모리 설정 확인 (512MB)
- **세션 만료**: TTL 설정 확인 (30분)

## 최종 산출물
- **개발자 A**: DynamoDB 테이블 3개, Lambda 함수 1개, API Gateway
- **개발자 B**: Django REST API, 실시간 대시보드, 이벤트 추적 스크립트
- **공통**: 통합 테스트, 데모 데이터, 프레젠테이션 자료

이 공통 프롬프트를 기반으로 각자의 전용 프롬프트를 참조하여 개발하세요.