# LiveInsight ë°°í¬ ê°€ì´ë“œ

## ğŸ“‹ ë°°í¬ ê°œìš”

LiveInsightëŠ” AWS ì„œë²„ë¦¬ìŠ¤ ì•„í‚¤í…ì²˜ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ ì‹¤ì‹œê°„ ì›¹ì‚¬ì´íŠ¸ ì‚¬ìš©ì í–‰ë™ ë¶„ì„ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤. ì´ ê°€ì´ë“œëŠ” Terraformì„ ì‚¬ìš©í•˜ì—¬ ì „ì²´ ì¸í”„ë¼ë¥¼ ë°°í¬í•˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í•©ë‹ˆë‹¤.

## ğŸ› ï¸ ì‚¬ì „ ìš”êµ¬ì‚¬í•­

### í•„ìˆ˜ ë„êµ¬
- **AWS CLI** (v2.0+) - ì„¤ì • ì™„ë£Œ í•„ìˆ˜
- **Terraform** (v1.0+) - ì¸í”„ë¼ ë°°í¬ìš©
- **Docker** (20.0+) - ì´ë¯¸ì§€ ë¹Œë“œìš©
- **Python** (3.11+) - Django ì• í”Œë¦¬ì¼€ì´ì…˜

### AWS ê¶Œí•œ
ë‹¤ìŒ AWS ì„œë¹„ìŠ¤ì— ëŒ€í•œ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤:
- DynamoDB, Lambda, API Gateway
- ECS, ECR, VPC, ALB
- IAM, CloudWatch, X-Ray

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### 1. í™˜ê²½ ì¤€ë¹„
```bash
# AWS CLI ì„¤ì • í™•ì¸
aws configure list
aws sts get-caller-identity
```

### 2. ì „ì²´ ì¸í”„ë¼ ë°°í¬
```bash
# í”„ë¡œì íŠ¸ ë£¨íŠ¸ì—ì„œ ì‹¤í–‰
cd infrastructure

# Terraform ì´ˆê¸°í™”
terraform init

# ë°°í¬ ê³„íš í™•ì¸
terraform plan

# ì „ì²´ ì¸í”„ë¼ ë°°í¬
terraform apply
```

### 3. ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬
```bash
# í”„ë¡œì íŠ¸ ë£¨íŠ¸ë¡œ ì´ë™
cd ..

# Docker ì´ë¯¸ì§€ ë¹Œë“œ ë° ë°°í¬
./scripts/build.sh

# ECS ì„œë¹„ìŠ¤ ì—…ë°ì´íŠ¸
aws ecs update-service --cluster LiveInsight-cluster --service LiveInsight-service --force-new-deployment
```

### 4. ë°°í¬ ê²€ì¦
```bash
# ë¦¬ì†ŒìŠ¤ ìƒíƒœ í™•ì¸
cd infrastructure
terraform output

# í—¬ìŠ¤ì²´í¬
ALB_DNS=$(terraform output -raw web_app_url | sed 's|http://||')
curl "http://$ALB_DNS/health/"
```

## ğŸ“Š ë°°í¬ëœ ë¦¬ì†ŒìŠ¤

### ì„œë²„ë¦¬ìŠ¤ ë°±ì—”ë“œ
- **DynamoDB í…Œì´ë¸”**: Events, Sessions, ActiveSessions
- **Lambda í•¨ìˆ˜**: EventCollector (ì´ë²¤íŠ¸ ìˆ˜ì§‘ ë° ì²˜ë¦¬)
- **API Gateway**: REST API (/events ì—”ë“œí¬ì¸íŠ¸)

### ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜
- **ECS Fargate**: Django ì• í”Œë¦¬ì¼€ì´ì…˜ (Auto Scaling)
- **ALB**: Application Load Balancer
- **VPC**: ë„¤íŠ¸ì›Œí¬ ì¸í”„ë¼ (Public/Private Subnets)
- **ECR**: Docker ì´ë¯¸ì§€ ë ˆì§€ìŠ¤íŠ¸ë¦¬

### ëª¨ë‹ˆí„°ë§
- **CloudWatch**: ë©”íŠ¸ë¦­, ì•ŒëŒ, ëŒ€ì‹œë³´ë“œ
- **X-Ray**: ë¶„ì‚° íŠ¸ë ˆì´ì‹±

## ğŸ”§ í™˜ê²½ë³„ ë°°í¬

### ê°œë°œ í™˜ê²½
```bash
# terraform.tfvars ì„¤ì •
cat > infrastructure/terraform.tfvars << EOF
aws_region = "us-east-1"
environment = "development"
project_name = "LiveInsight-Dev"
EOF

# ë°°í¬
cd infrastructure
terraform apply
```

### í”„ë¡œë•ì…˜ í™˜ê²½
```bash
# terraform.tfvars ì„¤ì •
cat > infrastructure/terraform.tfvars << EOF
aws_region = "us-east-1"
environment = "production"
project_name = "LiveInsight"
EOF

# ë¸”ë£¨-ê·¸ë¦° ë°°í¬
./scripts/blue-green-deploy.sh
```

## ğŸ“ ë°°í¬ í›„ ì„¤ì •

### ì„œë¹„ìŠ¤ URL í™•ì¸
```bash
cd infrastructure
terraform output
```

### ì£¼ìš” ì—”ë“œí¬ì¸íŠ¸
- **ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜**: Terraform outputì˜ `web_app_url`
- **API Gateway**: Terraform outputì˜ `api_gateway_url`
- **CloudWatch ëŒ€ì‹œë³´ë“œ**: AWS ì½˜ì†”ì—ì„œ í™•ì¸

## ğŸ§ª ë°°í¬ ê²€ì¦

### ìë™ í…ŒìŠ¤íŠ¸
```bash
# í†µí•© í…ŒìŠ¤íŠ¸
./scripts/run-tests.sh

# ë°°í¬ ê²€ì¦
./scripts/test.sh deployment
```

### ìˆ˜ë™ ê²€ì¦
```bash
# DynamoDB í…Œì´ë¸” í™•ì¸
aws dynamodb list-tables --query 'TableNames[?contains(@, `LiveInsight`)]'

# Lambda í•¨ìˆ˜ í™•ì¸
aws lambda get-function --function-name LiveInsight-EventCollector

# ECS ì„œë¹„ìŠ¤ í™•ì¸
aws ecs describe-services --cluster LiveInsight-cluster --services LiveInsight-service

# í—¬ìŠ¤ì²´í¬
ALB_DNS=$(cd infrastructure && terraform output -raw web_app_url | sed 's|http://||')
curl "http://$ALB_DNS/health/"
```

## ğŸ”„ ì—…ë°ì´íŠ¸ ë° ì¬ë°°í¬

### ì• í”Œë¦¬ì¼€ì´ì…˜ ì—…ë°ì´íŠ¸
```bash
# ì¼ë°˜ ë°°í¬
./scripts/build.sh
aws ecs update-service --cluster LiveInsight-cluster --service LiveInsight-service --force-new-deployment

# ë¸”ë£¨-ê·¸ë¦° ë°°í¬
./scripts/blue-green-deploy.sh
```

### ì¸í”„ë¼ ì—…ë°ì´íŠ¸
```bash
cd infrastructure
terraform plan
terraform apply
```

### ë¡¤ë°±
```bash
./scripts/rollback.sh
```

## ğŸ—‘ï¸ ë¦¬ì†ŒìŠ¤ ì‚­ì œ

```bash
cd infrastructure
terraform destroy
```

## ğŸ’° ì˜ˆìƒ ë¹„ìš© (ì›”ê°„)

### ê¸°ë³¸ êµ¬ì„±
- **DynamoDB**: ~$12 (í”„ë¡œë¹„ì €ë‹ ëª¨ë“œ)
- **Lambda**: ~$2.20 (100ë§Œ ìš”ì²­)
- **API Gateway**: ~$3.50 (100ë§Œ ìš”ì²­)
- **ECS Fargate**: ~$15 (1 íƒœìŠ¤í¬)
- **ALB**: ~$20
- **NAT Gateway**: ~$32 (2ê°œ)
- **CloudWatch**: ~$5

**ì´ ì˜ˆìƒ ë¹„ìš©**: ~$90/ì›”

### ë¹„ìš© ì ˆì•½
```bash
# DynamoDB On-Demand ëª¨ë“œ
terraform apply -var="billing_mode=PAY_PER_REQUEST"

# ê°œë°œ í™˜ê²½ ìµœì í™”
terraform apply -var="ecs_desired_count=1" -var="nat_gateway_count=1"
```

## ğŸš¨ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ì¼ë°˜ì ì¸ ë¬¸ì œ

#### Terraform ì´ˆê¸°í™” ì‹¤íŒ¨
```bash
rm -rf .terraform
terraform init
```

#### Docker í”Œë«í¼ ë¬¸ì œ (ARM Mac)
```bash
# build.sh ìŠ¤í¬ë¦½íŠ¸ê°€ ìë™ìœ¼ë¡œ linux/amd64 í”Œë«í¼ìœ¼ë¡œ ë¹Œë“œ
cd src
docker build --platform linux/amd64 -t liveinsight:latest .
```

#### ECS ì„œë¹„ìŠ¤ ì‹œì‘ ì‹¤íŒ¨
```bash
# ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
aws ecs describe-services --cluster LiveInsight-cluster --services LiveInsight-service

# ë¡œê·¸ í™•ì¸
aws logs filter-log-events --log-group-name /ecs/LiveInsight
```

#### Lambda ë°°í¬ ì‹¤íŒ¨
```bash
# í•¨ìˆ˜ ìƒíƒœ í™•ì¸
aws lambda get-function --function-name LiveInsight-EventCollector

# ë¡œê·¸ í™•ì¸
aws logs describe-log-groups --log-group-name-prefix /aws/lambda/LiveInsight
```

## ğŸ“ ì§€ì›

### ë¡œê·¸ ìœ„ì¹˜
- **Lambda ë¡œê·¸**: `/aws/lambda/LiveInsight-EventCollector`
- **ECS ë¡œê·¸**: `/ecs/LiveInsight`
- **CloudWatch ë©”íŠ¸ë¦­**: `LiveInsight` ë„¤ì„ìŠ¤í˜ì´ìŠ¤