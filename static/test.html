<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LiveInsight í…ŒìŠ¤íŠ¸ í˜ì´ì§€</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 2rem;
        }
        .section {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }
        .button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        .button:hover {
            background: #0056b3;
        }
        .status {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
        .form-group {
            margin-bottom: 1rem;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .form-group input, .form-group textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸš€ LiveInsight í…ŒìŠ¤íŠ¸ í˜ì´ì§€</h1>
        <p>ì‹¤ì‹œê°„ ì›¹ ë¶„ì„ ì¶”ì  ìŠ¤í¬ë¦½íŠ¸ í…ŒìŠ¤íŠ¸</p>
    </div>

    <div class="section">
        <h2>ğŸ“Š ì¶”ì  ìƒíƒœ</h2>
        <div id="status" class="status">
            LiveInsight ì´ˆê¸°í™” ì¤‘...
        </div>
        <div>
            <strong>ì„¸ì…˜ ID:</strong> <span id="session-id">-</span><br>
            <strong>ì‚¬ìš©ì ID:</strong> <span id="user-id">-</span><br>
            <strong>í˜„ì¬ URL:</strong> <span id="current-url">-</span>
        </div>
    </div>

    <div class="section">
        <h2>ğŸ¯ ì´ë²¤íŠ¸ í…ŒìŠ¤íŠ¸</h2>
        <button class="button" onclick="testPageView()">í˜ì´ì§€ë·° ì¶”ì </button>
        <button class="button" onclick="testCustomEvent()">ì»¤ìŠ¤í…€ ì´ë²¤íŠ¸</button>
        <button class="button" onclick="testButtonClick()">ë²„íŠ¼ í´ë¦­</button>
        <button class="button" onclick="testFormSubmit()">í¼ ì œì¶œ</button>
        <button class="button" onclick="testScrollEvent()">ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸</button>
    </div>

    <div class="section">
        <h2>ğŸ“ ì»¤ìŠ¤í…€ ì´ë²¤íŠ¸ ìƒì„±</h2>
        <div class="form-group">
            <label for="event-type">ì´ë²¤íŠ¸ íƒ€ì…:</label>
            <input type="text" id="event-type" placeholder="ì˜ˆ: button_click" value="custom_test">
        </div>
        <div class="form-group">
            <label for="event-properties">ì†ì„± (JSON):</label>
            <textarea id="event-properties" rows="3" placeholder='{"key": "value"}'>{
  "test_property": "test_value",
  "timestamp": "custom"
}</textarea>
        </div>
        <button class="button" onclick="sendCustomEvent()">ì»¤ìŠ¤í…€ ì´ë²¤íŠ¸ ì „ì†¡</button>
    </div>

    <div class="section">
        <h2>ğŸ“‹ ì´ë²¤íŠ¸ ë¡œê·¸</h2>
        <button class="button" onclick="clearLog()">ë¡œê·¸ ì§€ìš°ê¸°</button>
        <div id="event-log" class="log">
            ì´ë²¤íŠ¸ ë¡œê·¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...
        </div>
    </div>

    <div class="section">
        <h2>ğŸ”§ ë””ë²„ê¹… ë„êµ¬</h2>
        <button class="button" onclick="showSessionInfo()">ì„¸ì…˜ ì •ë³´ ë³´ê¸°</button>
        <button class="button" onclick="showLocalStorage()">ë¡œì»¬ìŠ¤í† ë¦¬ì§€ ë³´ê¸°</button>
        <button class="button" onclick="testAPIConnection()">API ì—°ê²° í…ŒìŠ¤íŠ¸</button>
        <button class="button" onclick="clearAllData()">ëª¨ë“  ë°ì´í„° ì§€ìš°ê¸°</button>
    </div>

    <!-- LiveInsight ìŠ¤í¬ë¦½íŠ¸ -->
    <script src="./js/liveinsight.js"></script>
    <script>
        // LiveInsight ì´ˆê¸°í™”
        LiveInsight.init('test-site-key', {
            flushInterval: 2000 // í…ŒìŠ¤íŠ¸ìš©ìœ¼ë¡œ 2ì´ˆë¡œ ë‹¨ì¶•
        });

        // ë¡œê·¸ í•¨ìˆ˜
        function log(message) {
            const logDiv = document.getElementById('event-log');
            const timestamp = new Date().toLocaleTimeString();
            logDiv.innerHTML += `[${timestamp}] ${message}\n`;
            logDiv.scrollTop = logDiv.scrollHeight;
            console.log('LiveInsight Test:', message);
        }

        // ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateStatus() {
            try {
                const sessionData = JSON.parse(localStorage.getItem('liveinsight_session') || '{}');
                const userId = localStorage.getItem('liveinsight_user_id');
                
                document.getElementById('session-id').textContent = sessionData.sessionId || '-';
                document.getElementById('user-id').textContent = userId || '-';
                document.getElementById('current-url').textContent = window.location.href;
                document.getElementById('status').textContent = 'LiveInsight í™œì„±í™”ë¨ âœ…';
                
                log('ìƒíƒœ ì—…ë°ì´íŠ¸ ì™„ë£Œ');
            } catch (e) {
                document.getElementById('status').textContent = 'LiveInsight ì˜¤ë¥˜ âŒ';
                log('ìƒíƒœ ì—…ë°ì´íŠ¸ ì˜¤ë¥˜: ' + e.message);
            }
        }

        // í…ŒìŠ¤íŠ¸ í•¨ìˆ˜ë“¤
        function testPageView() {
            LiveInsight.track('page_view', {
                test: true,
                manual_trigger: true
            });
            log('í˜ì´ì§€ë·° ì´ë²¤íŠ¸ ì „ì†¡');
        }

        function testCustomEvent() {
            LiveInsight.track('test_event', {
                category: 'testing',
                action: 'manual_test',
                value: Math.floor(Math.random() * 100)
            });
            log('ì»¤ìŠ¤í…€ ì´ë²¤íŠ¸ ì „ì†¡');
        }

        function testButtonClick() {
            LiveInsight.track('button_click', {
                button_id: 'test-button',
                button_text: 'í…ŒìŠ¤íŠ¸ ë²„íŠ¼',
                click_count: 1
            });
            log('ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ì „ì†¡');
        }

        function testFormSubmit() {
            LiveInsight.track('form_submit', {
                form_type: 'test_form',
                form_fields: ['name', 'email'],
                validation_passed: true
            });
            log('í¼ ì œì¶œ ì´ë²¤íŠ¸ ì „ì†¡');
        }

        function testScrollEvent() {
            LiveInsight.track('scroll_depth', {
                depth_percent: 75,
                page_height: document.body.scrollHeight,
                viewport_height: window.innerHeight
            });
            log('ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ ì „ì†¡');
        }

        function sendCustomEvent() {
            const eventType = document.getElementById('event-type').value;
            const propertiesText = document.getElementById('event-properties').value;
            
            try {
                const properties = JSON.parse(propertiesText);
                LiveInsight.track(eventType, properties);
                log(`ì»¤ìŠ¤í…€ ì´ë²¤íŠ¸ ì „ì†¡: ${eventType}`);
            } catch (e) {
                log('JSON íŒŒì‹± ì˜¤ë¥˜: ' + e.message);
                alert('ì†ì„± JSON í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
            }
        }

        function clearLog() {
            document.getElementById('event-log').innerHTML = 'ë¡œê·¸ê°€ ì§€ì›Œì¡ŒìŠµë‹ˆë‹¤.\n';
        }

        function showSessionInfo() {
            try {
                const sessionData = localStorage.getItem('liveinsight_session');
                const userData = localStorage.getItem('liveinsight_user_id');
                
                log('=== ì„¸ì…˜ ì •ë³´ ===');
                log('ì„¸ì…˜ ë°ì´í„°: ' + (sessionData || 'ì—†ìŒ'));
                log('ì‚¬ìš©ì ID: ' + (userData || 'ì—†ìŒ'));
                log('==================');
            } catch (e) {
                log('ì„¸ì…˜ ì •ë³´ ì¡°íšŒ ì˜¤ë¥˜: ' + e.message);
            }
        }

        function showLocalStorage() {
            log('=== ë¡œì»¬ìŠ¤í† ë¦¬ì§€ ===');
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.startsWith('liveinsight_')) {
                    log(`${key}: ${localStorage.getItem(key)}`);
                }
            }
            log('==================');
        }

        function testAPIConnection() {
            log('API ì—°ê²° í…ŒìŠ¤íŠ¸ ì‹œì‘...');
            
            fetch('https://k2eb4xeb24.execute-api.us-east-1.amazonaws.com/dev/api/events', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    events: [{
                        event_type: 'api_test',
                        timestamp: Date.now(),
                        test: true
                    }]
                })
            })
            .then(response => {
                log(`API ì‘ë‹µ: ${response.status} ${response.statusText}`);
                return response.text();
            })
            .then(data => {
                log(`API ì‘ë‹µ ë°ì´í„°: ${data}`);
            })
            .catch(error => {
                log(`API ì˜¤ë¥˜: ${error.message}`);
            });
        }

        function clearAllData() {
            localStorage.removeItem('liveinsight_session');
            localStorage.removeItem('liveinsight_user_id');
            log('ëª¨ë“  LiveInsight ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
            updateStatus();
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìƒíƒœ ì—…ë°ì´íŠ¸
        window.addEventListener('load', function() {
            setTimeout(updateStatus, 1000);
        });

        // ì£¼ê¸°ì  ìƒíƒœ ì—…ë°ì´íŠ¸
        setInterval(updateStatus, 5000);

        // ì´ˆê¸° ë¡œê·¸
        log('LiveInsight í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ë¡œë“œë¨');
    </script>
</body>
</html>