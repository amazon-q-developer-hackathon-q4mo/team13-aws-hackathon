# LiveInsight 시스템 아키텍처 다이어그램

## 🏗️ 전체 시스템 아키텍처

```mermaid
graph TB
    subgraph "클라이언트 사이드"
        A[웹사이트 방문자] --> B[JavaScript SDK<br/>liveinsight-tracker.js]
        B --> C[이벤트 수집<br/>page_view, click, conversion, heartbeat]
    end
    
    subgraph "AWS 서버리스 인프라"
        C --> D[API Gateway<br/>CORS 처리]
        D --> E[Lambda Function<br/>이벤트 처리]
        E --> F[DynamoDB<br/>데이터 저장]
        E --> G[CloudWatch<br/>메트릭 & 로그]
    end
    
    subgraph "웹 애플리케이션"
        H[Django REST API] --> F
        I[실시간 대시보드<br/>Chart.js] --> H
    end
    
    subgraph "모니터링 & 보안"
        G --> K[CloudWatch Alarms]
    end
    
    style A fill:#e1f5fe
    style F fill:#fff3e0
    style E fill:#f3e5f5
    style I fill:#e8f5e8
```

## 📊 데이터 흐름 다이어그램

```mermaid
sequenceDiagram
    participant U as 사용자
    participant JS as JavaScript SDK
    participant API as API Gateway
    participant L as Lambda
    participant DB as DynamoDB
    participant WEB as Django API
    participant DASH as 대시보드
    
    U->>JS: 페이지 방문
    JS->>JS: 사용자/세션 ID 생성
    JS->>API: POST /events (이벤트 데이터)
    API->>L: 이벤트 처리 요청
    
    L->>L: 이벤트 데이터 생성
    L->>L: 세션 관리 로직
    L->>DB: Events 테이블 저장
    L->>DB: Sessions 테이블 업데이트
    L->>DB: ActiveSessions 테이블 업데이트
    L->>API: 처리 완료 응답
    API->>JS: 200 OK
    
    DASH->>WEB: GET /api/sessions/active
    WEB->>DB: ActiveSessions 스캔
    DB->>WEB: 활성 세션 데이터
    WEB->>DASH: JSON 응답
    DASH->>DASH: 실시간 차트 업데이트
```

## 🚀 배포 아키텍처

```mermaid
graph TB
    subgraph "프로덕션 환경"
        A[Route 53<br/>DNS] --> B[CloudFront<br/>CDN]
        B --> C[Application Load Balancer]
        C --> D[ECS Fargate<br/>Django 앱]
        
        E[API Gateway] --> F[Lambda Functions]
        F --> G[DynamoDB]
        
        D --> G
        
        H[WAF] --> B
        I[GuardDuty] --> J[보안 모니터링]
        
        G --> K[백업 시스템]
        L[CloudWatch] --> M[알람 & 로그]
    end
    
    subgraph "개발 환경"
        N[로컬 Django] --> O[로컬 DynamoDB]
        P[테스트 스크립트] --> N
    end
    
    style D fill:#e8f5e8
    style F fill:#f3e5f5
    style G fill:#fff3e0
```

## 📊 성능 메트릭 대시보드

```mermaid
graph LR
    subgraph "CloudWatch 메트릭"
        A[EventsProcessed<br/>처리된 이벤트 수] --> D[대시보드]
        B[ProcessingTime<br/>처리 시간] --> D
        C[ProcessingErrors<br/>처리 오류] --> D
    end
    
    subgraph "DynamoDB 메트릭"
        E[ConsumedReadCapacity] --> D
        F[ConsumedWriteCapacity] --> D
        G[ThrottledRequests] --> D
    end
    
    subgraph "Lambda 메트릭"
        H[Duration<br/>실행 시간] --> D
        I[Errors<br/>오류 수] --> D
        J[Invocations<br/>호출 수] --> D
    end
    
    D --> K[알람 설정]
    K --> L[SNS 알림]
    
    style D fill:#e3f2fd
    style K fill:#ffebee
```

이 다이어그램들은 LiveInsight 시스템의 전체적인 구조와 데이터 흐름을 시각적으로 보여줍니다. 각 컴포넌트 간의 관계와 데이터 처리 과정을 명확하게 이해할 수 있도록 구성했습니다.