# ë‹´ë‹¹ì A - ë¦¬ìŠ¤í¬ ëŒ€ì‘ ë§¤ë‰´ì–¼

## ğŸš¨ ê¸´ê¸‰ ìƒí™© ëŒ€ì‘ ê°€ì´ë“œ

### Phaseë³„ ìµœì†Œ ì„±ê³µ ê¸°ì¤€
- **Phase 1 (4ì‹œê°„)**: DynamoDB + IAM ì™„ì„± â†’ ë‹´ë‹¹ì B ë¡œì»¬ ê°œë°œ ê°€ëŠ¥
- **Phase 2 (12ì‹œê°„)**: Lambda + API Gateway â†’ ê¸°ë³¸ API ë™ì‘
- **Phase 3 (18ì‹œê°„)**: í†µí•© í…ŒìŠ¤íŠ¸ â†’ ë°ëª¨ ê°€ëŠ¥í•œ ìƒíƒœ
- **Phase 4 (24ì‹œê°„)**: ë¬¸ì„œí™” + ë°œí‘œ ì¤€ë¹„

## âš ï¸ ì£¼ìš” ë¦¬ìŠ¤í¬ ì‹œë‚˜ë¦¬ì˜¤ ë° ëŒ€ì‘

### 1. DynamoDB ìŠ¤í‚¤ë§ˆ ë³€ê²½ ìš”ì²­ (í™•ë¥ : 30%)
#### ìƒí™©
- ë‹´ë‹¹ì Bê°€ 2ì‹œê°„ í›„ ìŠ¤í‚¤ë§ˆ ë³€ê²½ ìš”ì²­
- ê¸°ì¡´ í…Œì´ë¸” êµ¬ì¡°ë¡œëŠ” ìš”êµ¬ì‚¬í•­ ì¶©ì¡± ë¶ˆê°€

#### ì¦‰ì‹œ ëŒ€ì‘ (5ë¶„ ë‚´)
```bash
# í˜„ì¬ ìƒíƒœ ë°±ì—…
terraform state pull > backup-state.json

# ë³€ê²½ì‚¬í•­ ì ìš© ì „ ì˜í–¥ë„ ë¶„ì„
terraform plan -out=schema-change.plan
```

#### ëŒ€ì‘ ë°©ì•ˆ
1. **ë³€ê²½ ê°€ëŠ¥ (2ì‹œê°„ ë‚´)**: ì¦‰ì‹œ ìŠ¤í‚¤ë§ˆ ìˆ˜ì • í›„ ì¬ë°°í¬
2. **ë³€ê²½ ë¶ˆê°€ (2ì‹œê°„ í›„)**: Phase 2ì—ì„œ ë§ˆì´ê·¸ë ˆì´ì…˜ ê³„íš
3. **ê¸´ê¸‰ ìƒí™©**: ê¸°ë³¸ ìŠ¤í‚¤ë§ˆ ìœ ì§€, ì• í”Œë¦¬ì¼€ì´ì…˜ ë ˆë²¨ì—ì„œ í•´ê²°

### 2. Lambda ë°°í¬ ì‹¤íŒ¨ (í™•ë¥ : 40%)
#### ìƒí™©
- ì½”ë“œ íŒ¨í‚¤ì§• ì˜¤ë¥˜ ë˜ëŠ” ê¶Œí•œ ë¬¸ì œ
- terraform apply ì‹œ Lambda í•¨ìˆ˜ ìƒì„± ì‹¤íŒ¨

#### ì¦‰ì‹œ ëŒ€ì‘ (1ë¶„ ë‚´)
```bash
# ì—ëŸ¬ ë¡œê·¸ í™•ì¸
terraform show
aws logs describe-log-groups --log-group-name-prefix "/aws/lambda/liveinsight"

# ë”ë¯¸ í•¨ìˆ˜ë¡œ ìš°ì„  ë°°í¬
echo 'def handler(event, context): return {"statusCode": 200}' > dummy.py
zip dummy.zip dummy.py
```

#### ëŒ€ì‘ ë°©ì•ˆ
1. **ë”ë¯¸ í•¨ìˆ˜ ë°°í¬**: ì¸í”„ë¼ ë¨¼ì € ì™„ì„±
2. **ê¶Œí•œ ì¬í™•ì¸**: IAM ì •ì±… ì ê²€
3. **ìˆ˜ë™ ì—…ë¡œë“œ**: AWS ì½˜ì†”ì—ì„œ ì§ì ‘ ì—…ë¡œë“œ

### 3. API Gateway CORS ë¬¸ì œ (í™•ë¥ : 50%)
#### ìƒí™©
- ë¸Œë¼ìš°ì €ì—ì„œ CORS ì—ëŸ¬ ë°œìƒ
- í”„ë¡ íŠ¸ì—”ë“œì—ì„œ API í˜¸ì¶œ ë¶ˆê°€

#### ì¦‰ì‹œ ëŒ€ì‘ (30ì´ˆ ë‚´)
```bash
# ì™€ì¼ë“œì¹´ë“œë¡œ ì„ì‹œ í•´ê²°
# terraform/api_gateway.tfì—ì„œ CORS ì„¤ì • í™•ì¸
```

#### ëŒ€ì‘ ë°©ì•ˆ
1. **ì™€ì¼ë“œì¹´ë“œ í—ˆìš©**: `Access-Control-Allow-Origin: *`
2. **OPTIONS ë©”ì„œë“œ ì¶”ê°€**: ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ì— OPTIONS ì¶”ê°€
3. **ìˆ˜ë™ ì„¤ì •**: AWS ì½˜ì†”ì—ì„œ ì§ì ‘ CORS í™œì„±í™”

### 4. Terraform ìƒíƒœ ì¶©ëŒ (í™•ë¥ : 20%)
#### ìƒí™©
- ë™ì‹œ ë°°í¬ë¡œ ì¸í•œ ìƒíƒœ íŒŒì¼ ì ê¸ˆ
- ìƒíƒœ íŒŒì¼ ì†ìƒ ë˜ëŠ” ë¶ˆì¼ì¹˜

#### ì¦‰ì‹œ ëŒ€ì‘ (2ë¶„ ë‚´)
```bash
# ì ê¸ˆ í•´ì œ
terraform force-unlock LOCK_ID

# ìƒíƒœ íŒŒì¼ ë³µêµ¬
terraform state pull > current-state.json
terraform import aws_dynamodb_table.events liveinsight-events-dev
```

#### ëŒ€ì‘ ë°©ì•ˆ
1. **S3 ë°±ì—”ë“œ ì„¤ì •**: ìƒíƒœ íŒŒì¼ ì¤‘ì•™ ê´€ë¦¬
2. **DynamoDB ì ê¸ˆ**: ë™ì‹œ ì ‘ê·¼ ë°©ì§€
3. **ë¡œì»¬ ë°±ì—…**: ì •ê¸°ì  ìƒíƒœ íŒŒì¼ ë°±ì—…

## ğŸ”„ ë‹¨ê³„ë³„ ë¡¤ë°± ê³„íš

### Phase 1 ì‹¤íŒ¨ ì‹œ
```bash
# ìµœì†Œí•œì˜ DynamoDBë§Œ ìœ ì§€
terraform destroy -target=aws_lambda_function.event_collector
terraform destroy -target=aws_api_gateway_rest_api.main
# DynamoDB í…Œì´ë¸”ì€ ìœ ì§€í•˜ì—¬ ë‹´ë‹¹ì B ê°œë°œ ì§€ì›
```

### Phase 2 ì‹¤íŒ¨ ì‹œ
```bash
# Lambda ì—†ì´ API Gatewayë§Œ í…ŒìŠ¤íŠ¸
# ë”ë¯¸ ì‘ë‹µìœ¼ë¡œ í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ ì§€ì›
```

### Phase 3 ì‹¤íŒ¨ ì‹œ
```bash
# ëª¨ë‹ˆí„°ë§ ì—†ì´ ê¸°ë³¸ ê¸°ëŠ¥ë§Œ ìœ ì§€
terraform destroy -target=aws_cloudwatch_metric_alarm.lambda_errors
```

## ğŸ“ ì—ìŠ¤ì»¬ë ˆì´ì…˜ ì ˆì°¨

### 1ë‹¨ê³„: ìì²´ í•´ê²° (5ë¶„)
- ë¬¸ì„œ ë° ë¡œê·¸ í™•ì¸
- ê¸°ë³¸ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ì‹¤í–‰

### 2ë‹¨ê³„: ë‹´ë‹¹ì B í˜‘ì˜ (10ë¶„)
- ìš”êµ¬ì‚¬í•­ ì¬í™•ì¸
- ëŒ€ì•ˆ ë°©ì•ˆ í˜‘ì˜

### 3ë‹¨ê³„: ìš°ì„ ìˆœìœ„ ì¡°ì • (15ë¶„)
- í•µì‹¬ ê¸°ëŠ¥ ìš°ì„  ì™„ì„±
- ë¶€ê°€ ê¸°ëŠ¥ í¬ê¸° ê²°ì •

### 4ë‹¨ê³„: ìµœì†Œ ê¸°ëŠ¥ êµ¬í˜„ (30ë¶„)
- MVP ìµœì†Œ ìš”êµ¬ì‚¬í•­ë§Œ ì¶©ì¡±
- ë°ëª¨ ê°€ëŠ¥í•œ ìˆ˜ì¤€ìœ¼ë¡œ ì¶•ì†Œ

## ğŸ› ï¸ ì‘ê¸‰ ë³µêµ¬ ë„êµ¬

### ë¹ ë¥¸ ì§„ë‹¨ ìŠ¤í¬ë¦½íŠ¸
```bash
#!/bin/bash
# scripts/health-check.sh

echo "ğŸ” ì¸í”„ë¼ ìƒíƒœ ì ê²€..."

# Terraform ìƒíƒœ í™•ì¸
terraform state list | wc -l
echo "Terraform ë¦¬ì†ŒìŠ¤ ìˆ˜: $(terraform state list | wc -l)"

# AWS ë¦¬ì†ŒìŠ¤ í™•ì¸
aws dynamodb list-tables --query 'TableNames[?contains(@, `liveinsight`)]'
aws lambda list-functions --query 'Functions[?contains(FunctionName, `liveinsight`)].FunctionName'
aws apigateway get-rest-apis --query 'items[?contains(name, `liveinsight`)].name'

echo "âœ… ì ê²€ ì™„ë£Œ"
```

### ê¸´ê¸‰ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸
```bash
#!/bin/bash
# scripts/emergency-deploy.sh

echo "ğŸš¨ ê¸´ê¸‰ ë°°í¬ ì‹œì‘..."

# ìµœì†Œ ë¦¬ì†ŒìŠ¤ë§Œ ë°°í¬
terraform apply -target=aws_dynamodb_table.events -auto-approve
terraform apply -target=aws_dynamodb_table.sessions -auto-approve
terraform apply -target=aws_iam_role.lambda_role -auto-approve

echo "âœ… ìµœì†Œ ì¸í”„ë¼ ë°°í¬ ì™„ë£Œ"
```

## ğŸ“Š ë¦¬ìŠ¤í¬ ëª¨ë‹ˆí„°ë§

### ì‹¤ì‹œê°„ ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] Terraform plan ì—ëŸ¬ ì—†ìŒ
- [ ] AWS ìê²©ì¦ëª… ìœ íš¨
- [ ] DynamoDB í…Œì´ë¸” ìƒì„± ì™„ë£Œ
- [ ] IAM ì—­í•  ì •ìƒ ë™ì‘
- [ ] Lambda í•¨ìˆ˜ ë°°í¬ ì„±ê³µ
- [ ] API Gateway ì—”ë“œí¬ì¸íŠ¸ ì‘ë‹µ

### ê²½ê³  ì‹ í˜¸
- âš ï¸ Terraform planì—ì„œ destroy í•­ëª© ë°œê²¬
- âš ï¸ AWS ë¹„ìš© ì•ŒëŒ ë°œìƒ
- âš ï¸ Lambda í•¨ìˆ˜ ì—ëŸ¬ìœ¨ 10% ì´ˆê³¼
- âš ï¸ API Gateway 4xx/5xx ì—ëŸ¬ ì¦ê°€

## ğŸ¯ ì„±ê³µ í™•ë¥  ë†’ì´ëŠ” ì „ëµ

### 1. ì ì§„ì  ë°°í¬
- í•œ ë²ˆì— ëª¨ë“  ë¦¬ì†ŒìŠ¤ ë°°í¬ ê¸ˆì§€
- ë‹¨ê³„ë³„ë¡œ ê²€ì¦ í›„ ë‹¤ìŒ ë‹¨ê³„ ì§„í–‰

### 2. ë”ë¯¸ ë°ì´í„° í™œìš©
- ì‹¤ì œ ì½”ë“œ ì—†ì´ë„ ì¸í”„ë¼ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
- ë‹´ë‹¹ì B ì½”ë“œ ì™„ì„± ì „ì— ë¯¸ë¦¬ ê²€ì¦

### 3. ë°±ì—… ê³„íš ìƒì‹œ ì¤€ë¹„
- ë§¤ ë‹¨ê³„ë§ˆë‹¤ ìƒíƒœ íŒŒì¼ ë°±ì—…
- ì´ì „ ë‹¨ê³„ë¡œ ì¦‰ì‹œ ë¡¤ë°± ê°€ëŠ¥í•œ ìƒíƒœ ìœ ì§€

ì´ ë§¤ë‰´ì–¼ì„ ì°¸ê³ í•˜ì—¬ ìœ„ê¸° ìƒí™©ì—ì„œë„ ì¹¨ì°©í•˜ê²Œ ëŒ€ì‘í•˜ì—¬ í”„ë¡œì íŠ¸ë¥¼ ì„±ê³µì ìœ¼ë¡œ ì™„ìˆ˜í•©ì‹œë‹¤! ğŸš€