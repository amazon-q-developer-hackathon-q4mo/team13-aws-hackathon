# LiveInsight AWS ë¦¬ì†ŒìŠ¤ ê´€ë¦¬ ë¬¸ì„œ

## ğŸ“Š ë°°í¬ ì •ë³´ (Phase 1-2 ì™„ë£Œ)
- **AWS ë¦¬ì „**: us-east-1
- **í™˜ê²½**: dev
- **ë°°í¬ ìƒíƒœ**: âœ… ì™„ë£Œ (59ê°œ ë¦¬ì†ŒìŠ¤)
- **API Gateway ID**: k2eb4xeb24
- **CloudFront Distribution ID**: E2IKLPPDM8PJW3
- **S3 Bucket**: liveinsight-static-dev-c02ed440

## ğŸ—‚ï¸ ìƒì„±ëœ ë¦¬ì†ŒìŠ¤ ëª©ë¡ (ì´ 59ê°œ)

### ğŸ—„ï¸ DynamoDB í…Œì´ë¸” (2ê°œ)
| ë¦¬ì†ŒìŠ¤ëª… | íƒ€ì… | ìš©ë„ | íŠ¹ì§• |
|---------|------|------|------|
| liveinsight-events-dev | DynamoDB Table | ì´ë²¤íŠ¸ ë°ì´í„° ì €ì¥ | TTL 24ì‹œê°„, GSI í¬í•¨ |
| liveinsight-sessions-dev | DynamoDB Table | ì„¸ì…˜ ë°ì´í„° ì €ì¥ | ActivityIndex GSI |

### âš¡ Lambda í•¨ìˆ˜ (3ê°œ)
| ë¦¬ì†ŒìŠ¤ëª… | íƒ€ì… | ìš©ë„ | ìƒíƒœ |
|---------|------|------|------|
| liveinsight-event-collector-dev | Lambda Function | POST /api/events | âœ… ë°°í¬ì™„ë£Œ |
| liveinsight-realtime-api-dev | Lambda Function | GET /api/realtime | âœ… ë°°í¬ì™„ë£Œ |
| liveinsight-stats-api-dev | Lambda Function | GET /api/stats | âœ… ë°°í¬ì™„ë£Œ |

### ğŸŒ API Gateway (1ê°œ + 6ê°œ ë©”ì„œë“œ)
| ë¦¬ì†ŒìŠ¤ëª… | íƒ€ì… | URL | ìƒíƒœ |
|---------|------|-----|------|
| liveinsight-api-dev | REST API | https://k2eb4xeb24.execute-api.us-east-1.amazonaws.com/dev | âœ… í™œì„±í™” |

### ğŸª£ S3 + CloudFront (ì •ì  íŒŒì¼ í˜¸ìŠ¤íŒ…)
| ë¦¬ì†ŒìŠ¤ëª… | íƒ€ì… | URL | ìš©ë„ |
|---------|------|-----|------|
| liveinsight-static-dev-c02ed440 | S3 Bucket | http://liveinsight-static-dev-c02ed440.s3-website-us-east-1.amazonaws.com | ì •ì  íŒŒì¼ |
| E2IKLPPDM8PJW3 | CloudFront | https://d28t8gs7tn78ne.cloudfront.net | ê¸€ë¡œë²Œ CDN |

### ğŸ” IAM ì—­í•  ë° ì •ì±… (3ê°œ)
| ë¦¬ì†ŒìŠ¤ëª… | íƒ€ì… | ìš©ë„ | ê¶Œí•œ |
|---------|------|------|------|
| liveinsight-lambda-role-dev | IAM Role | Lambda ì‹¤í–‰ ì—­í•  | DynamoDB ì½ê¸°/ì“°ê¸° |
| lambda_dynamodb_policy | IAM Policy | DynamoDB ì ‘ê·¼ | GetItem, PutItem, Query ë“± |
| lambda_basic_execution | IAM Policy Attachment | CloudWatch ë¡œê·¸ | ë¡œê·¸ ìƒì„±/ì“°ê¸° |

### ğŸ“Š CloudWatch ëª¨ë‹ˆí„°ë§ (12ê°œ)
| ë¦¬ì†ŒìŠ¤ëª… | íƒ€ì… | ìš©ë„ | ì„ê³„ê°’ |
|---------|------|------|--------|
| event_collector_errors | Metric Alarm | Lambda ì—ëŸ¬ ëª¨ë‹ˆí„°ë§ | 5ê°œ/5ë¶„ |
| realtime_api_errors | Metric Alarm | Lambda ì—ëŸ¬ ëª¨ë‹ˆí„°ë§ | 5ê°œ/5ë¶„ |
| stats_api_errors | Metric Alarm | Lambda ì—ëŸ¬ ëª¨ë‹ˆí„°ë§ | 5ê°œ/5ë¶„ |
| api_gateway_4xx_errors | Metric Alarm | API 4xx ì—ëŸ¬ | 10ê°œ/5ë¶„ |
| api_gateway_5xx_errors | Metric Alarm | API 5xx ì—ëŸ¬ | 5ê°œ/5ë¶„ |
| dynamodb_events_read_throttles | Metric Alarm | DynamoDB ìŠ¤ë¡œí‹€ë§ | 1ê°œ/5ë¶„ |
| dynamodb_events_write_throttles | Metric Alarm | DynamoDB ìŠ¤ë¡œí‹€ë§ | 1ê°œ/5ë¶„ |
| event_collector_duration | Metric Alarm | Lambda ì‹¤í–‰ì‹œê°„ | 25ì´ˆ |

### ğŸ“ CloudWatch ë¡œê·¸ ê·¸ë£¹ (4ê°œ)
| ë¦¬ì†ŒìŠ¤ëª… | ë³´ì¡´ê¸°ê°„ | ìš©ë„ |
|---------|----------|------|
| /aws/lambda/liveinsight-event-collector-dev | 7ì¼ | Lambda ë¡œê·¸ |
| /aws/lambda/liveinsight-realtime-api-dev | 7ì¼ | Lambda ë¡œê·¸ |
| /aws/lambda/liveinsight-stats-api-dev | 7ì¼ | Lambda ë¡œê·¸ |
| API-Gateway-Execution-Logs_k2eb4xeb24/dev | 7ì¼ | API Gateway ë¡œê·¸ |

## ğŸ› ï¸ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬ ëª…ë ¹ì–´

### í˜„ì¬ ìƒíƒœ í™•ì¸
```bash
cd terraform

# ë°°í¬ëœ ë¦¬ì†ŒìŠ¤ ëª©ë¡ í™•ì¸ (59ê°œ)
terraform state list

# ì¶œë ¥ê°’ í™•ì¸ (URL ì •ë³´)
terraform output

# íŠ¹ì • ë¦¬ì†ŒìŠ¤ ìƒì„¸ ì •ë³´
terraform state show aws_api_gateway_rest_api.liveinsight_api
```

### ë¦¬ì†ŒìŠ¤ ì—…ë°ì´íŠ¸
```bash
cd terraform

# ë³€ê²½ì‚¬í•­ í™•ì¸
terraform plan

# ë³€ê²½ì‚¬í•­ ì ìš©
terraform apply

# íŠ¹ì • ë¦¬ì†ŒìŠ¤ë§Œ ì—…ë°ì´íŠ¸
terraform apply -target=aws_lambda_function.event_collector
```

### Lambda í•¨ìˆ˜ ì½”ë“œ ì—…ë°ì´íŠ¸
```bash
# ë‹´ë‹¹ì B ì½”ë“œ ë°°í¬ ì‹œ ì‚¬ìš©
aws lambda update-function-code \
  --function-name liveinsight-event-collector-dev \
  --zip-file fileb://function.zip

# í™˜ê²½ë³€ìˆ˜ í™•ì¸
aws lambda get-function-configuration \
  --function-name liveinsight-event-collector-dev
```

### ë¦¬ì†ŒìŠ¤ ì‚­ì œ (ì£¼ì˜!)
```bash
cd terraform

# ì‚­ì œ ê³„íš í™•ì¸
terraform plan -destroy

# ì „ì²´ ë¦¬ì†ŒìŠ¤ ì‚­ì œ
terraform destroy

# íŠ¹ì • ë¦¬ì†ŒìŠ¤ë§Œ ì‚­ì œ
terraform destroy -target=aws_s3_bucket.static_files
```

## ğŸ’° ë¹„ìš© ê´€ë¦¬

### í˜„ì¬ ì„¤ì •
- **DynamoDB**: On-Demand ëª¨ë“œ (ì‚¬ìš©ëŸ‰ ê¸°ë°˜ ê³¼ê¸ˆ)
- **Lambda**: 256MB, 30ì´ˆ íƒ€ì„ì•„ì›ƒ
- **API Gateway**: REST API (ìš”ì²­ë‹¹ ê³¼ê¸ˆ)
- **CloudFront**: ê¸€ë¡œë²Œ ë°°í¬ (íŠ¸ë˜í”½ ê¸°ë°˜)
- **S3**: í‘œì¤€ ìŠ¤í† ë¦¬ì§€ (ì €ì¥ëŸ‰ ê¸°ë°˜)

### ì˜ˆìƒ ë¹„ìš© (ê°œë°œ í™˜ê²½)
- **ì›” ì˜ˆìƒ ë¹„ìš©**: $3-8 (íŠ¸ë˜í”½ì— ë”°ë¼)
- **DynamoDB**: $0.25/GB + $1.25/ë°±ë§Œ ìš”ì²­
- **Lambda**: $0.20/ë°±ë§Œ ìš”ì²­ + $0.0000166667/GB-ì´ˆ
- **API Gateway**: $3.50/ë°±ë§Œ ìš”ì²­
- **CloudFront**: $0.085/GB (ì²« 10TB)

### ë¹„ìš© ìµœì í™” ì„¤ì •
- DynamoDB TTL: 24ì‹œê°„ ìë™ ì‚­ì œ
- CloudWatch ë¡œê·¸: 7ì¼ ë³´ì¡´
- Lambda ë©”ëª¨ë¦¬: 256MB (ìµœì í™”ë¨)

## ğŸ”’ ë³´ì•ˆ ì„¤ì •

### IAM ìµœì†Œ ê¶Œí•œ ì›ì¹™
- Lambda í•¨ìˆ˜ë³„ ê°œë³„ ì‹¤í–‰ ì—­í• 
- DynamoDB í…Œì´ë¸”ë³„ ì„¸ë¶„í™”ëœ ê¶Œí•œ
- CloudWatch ë¡œê·¸ ì“°ê¸° ê¶Œí•œë§Œ ë¶€ì—¬

### ë°ì´í„° ë³´í˜¸
- DynamoDB ì•”í˜¸í™”: AWS ê´€ë¦¬í˜• í‚¤ ì‚¬ìš©
- TTL ì„¤ì •: 24ì‹œê°„ í›„ ìë™ ë°ì´í„° ì‚­ì œ
- API Gateway CORS: ê°œë°œìš© ì™€ì¼ë“œì¹´ë“œ ì„¤ì •

### ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ
- HTTPS ê°•ì œ (API Gateway, CloudFront)
- S3 ë²„í‚· í¼ë¸”ë¦­ ì•¡ì„¸ìŠ¤ ì°¨ë‹¨
- CloudFront OAC ì„¤ì •

## ğŸ“Š ëª¨ë‹ˆí„°ë§ ë° ì•ŒëŒ

### ì„¤ì •ëœ ì•ŒëŒ (8ê°œ)
1. **Lambda ì—ëŸ¬ ì•ŒëŒ**: 5ë¶„ê°„ 5ê°œ ì´ìƒ ì—ëŸ¬ ì‹œ ì•Œë¦¼
2. **API Gateway ì—ëŸ¬**: 4xx/5xx ì—ëŸ¬ìœ¨ ëª¨ë‹ˆí„°ë§
3. **DynamoDB ìŠ¤ë¡œí‹€ë§**: ì½ê¸°/ì“°ê¸° ì œí•œ ëª¨ë‹ˆí„°ë§
4. **Lambda ì‹¤í–‰ì‹œê°„**: 25ì´ˆ ì´ìƒ ì‹œ ì•Œë¦¼

### ë¡œê·¸ í™•ì¸ ë°©ë²•
```bash
# Lambda ë¡œê·¸ ì‹¤ì‹œê°„ í™•ì¸
aws logs tail /aws/lambda/liveinsight-event-collector-dev --follow

# API Gateway ë¡œê·¸ í™•ì¸
aws logs tail API-Gateway-Execution-Logs_k2eb4xeb24/dev --follow

# ì—ëŸ¬ ë¡œê·¸ë§Œ í•„í„°ë§
aws logs filter-log-events \
  --log-group-name /aws/lambda/liveinsight-event-collector-dev \
  --filter-pattern "ERROR"
```

## âš ï¸ ì£¼ì˜ì‚¬í•­ ë° ì œí•œì‚¬í•­

### í˜„ì¬ ì•Œë ¤ì§„ ì´ìŠˆ
- **OPTIONS ë©”ì„œë“œ**: 500 ì—ëŸ¬ ë°˜í™˜ (ê¸°ëŠ¥ìƒ ë¬¸ì œì—†ìŒ)
- **ë”ë¯¸ ì½”ë“œ**: ì‹¤ì œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ êµ¬í˜„ í•„ìš”
- **ì¸ì¦ ì—†ìŒ**: ê°œë°œ í™˜ê²½ìš© (í”„ë¡œë•ì…˜ì—ì„œ ì¶”ê°€ í•„ìš”)

### ìš´ì˜ ì‹œ ê³ ë ¤ì‚¬í•­
- **ë°ì´í„° ë°±ì—…**: DynamoDB ë°±ì—… ì •ì±… ìˆ˜ë¦½ í•„ìš”
- **í™˜ê²½ ë¶„ë¦¬**: prod í™˜ê²½ ë³„ë„ êµ¬ì¶• ê¶Œì¥
- **ë„ë©”ì¸ ì—°ê²°**: Route 53 + ACM ì¸ì¦ì„œ í•„ìš”
- **API ì¸ì¦**: API Key ë˜ëŠ” Cognito ì—°ë™ ê³ ë ¤

### ë¦¬ì†ŒìŠ¤ ë³€ê²½ ì‹œ ì£¼ì˜ì 
- **DynamoDB ìŠ¤í‚¤ë§ˆ ë³€ê²½**: ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ í•„ìš”
- **Lambda ëŸ°íƒ€ì„ ë³€ê²½**: ì½”ë“œ í˜¸í™˜ì„± í™•ì¸
- **API Gateway ë³€ê²½**: í´ë¼ì´ì–¸íŠ¸ URL ì—…ë°ì´íŠ¸
- **ë¦¬ì „ ë³€ê²½**: ëª¨ë“  ë¦¬ì†ŒìŠ¤ ì¬ìƒì„± (ë°ì´í„° ì†ì‹¤)

## ğŸ¤ ë‹´ë‹¹ì B í˜‘ì—… ê°€ì´ë“œ

### ì œê³µ ê°€ëŠ¥í•œ ì •ë³´
- **API Base URL**: https://k2eb4xeb24.execute-api.us-east-1.amazonaws.com/dev
- **DynamoDB í…Œì´ë¸”ëª…**: liveinsight-events-dev, liveinsight-sessions-dev
- **Lambda í•¨ìˆ˜ëª…**: liveinsight-{service}-dev
- **í™˜ê²½ë³€ìˆ˜**: EVENTS_TABLE, SESSIONS_TABLE ìë™ ì„¤ì •

### ì½”ë“œ ë°°í¬ ì§€ì›
- Lambda í•¨ìˆ˜ ì—…ë°ì´íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì œê³µ
- í™˜ê²½ë³€ìˆ˜ ì„¤ì • ìë™í™”
- ë¡œê·¸ ëª¨ë‹ˆí„°ë§ ë° ë””ë²„ê¹… ì§€ì›
- API í…ŒìŠ¤íŠ¸ í™˜ê²½ ì œê³µ

---
**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: Phase 1-2 ì™„ë£Œ ì‹œì   
**ì´ ë°°í¬ ë¦¬ì†ŒìŠ¤**: 59ê°œ  
**ë¬¸ì„œ ë²„ì „**: 2.0 (ìµœì‹ í™” ì™„ë£Œ)