<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LiveInsight Dashboard</title>
    <link rel="stylesheet" href="/static/css/dashboard.css">
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
</head>
<body>
    <header class="header">
        <h1>ğŸ“Š LiveInsight Dashboard</h1>
    </header>

    <div class="container">
        <!-- ì‹¤ì‹œê°„ í†µê³„ ì¹´ë“œ -->
        <div class="stats-grid" 
             hx-get="https://k2eb4xeb24.execute-api.us-east-1.amazonaws.com/dev/api/realtime" 
             hx-trigger="load, every 5s"
             hx-target="#stats-content">
            <div id="stats-content">
                <div class="loading">í†µê³„ ë¡œë”© ì¤‘...</div>
            </div>
        </div>

        <!-- ì‹œê°„ëŒ€ë³„ ì´ë²¤íŠ¸ ì°¨íŠ¸ -->
        <div class="chart-container">
            <h2 class="chart-title">ì‹œê°„ëŒ€ë³„ ì´ë²¤íŠ¸ ë¶„í¬</h2>
            <div id="hourly-chart" 
                 hx-get="https://k2eb4xeb24.execute-api.us-east-1.amazonaws.com/dev/api/stats" 
                 hx-trigger="load, every 10s">
                <div class="loading">ì°¨íŠ¸ ë¡œë”© ì¤‘...</div>
            </div>
        </div>

        <!-- ì¸ê¸° í˜ì´ì§€ -->
        <div class="chart-container">
            <h2 class="chart-title">ì¸ê¸° í˜ì´ì§€</h2>
            <div id="popular-pages" 
                 hx-get="https://k2eb4xeb24.execute-api.us-east-1.amazonaws.com/dev/api/stats" 
                 hx-trigger="load, every 10s">
                <div class="loading">ë°ì´í„° ë¡œë”© ì¤‘...</div>
            </div>
        </div>

        <!-- ìµœê·¼ ì´ë²¤íŠ¸ -->
        <div class="events-list">
            <div class="events-header">
                ìµœê·¼ ì´ë²¤íŠ¸
                <button class="refresh-btn" 
                        hx-get="https://k2eb4xeb24.execute-api.us-east-1.amazonaws.com/dev/api/realtime" 
                        hx-target="#events-content">
                    ìƒˆë¡œê³ ì¹¨
                </button>
            </div>
            <div id="events-content" 
                 hx-get="https://k2eb4xeb24.execute-api.us-east-1.amazonaws.com/dev/api/realtime" 
                 hx-trigger="load, every 3s">
                <div class="loading">ì´ë²¤íŠ¸ ë¡œë”© ì¤‘...</div>
            </div>
        </div>
    </div>

    <script>
        // HTMX ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        document.body.addEventListener('htmx:responseError', function(evt) {
            console.error('HTMX Error:', evt.detail);
        });

        // ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ ìƒíƒœ í‘œì‹œ
        document.body.addEventListener('htmx:beforeRequest', function(evt) {
            const target = evt.target;
            if (target.id === 'stats-content') {
                // í†µê³„ ì—…ë°ì´íŠ¸ ì¤‘ í‘œì‹œ (ì„ íƒì‚¬í•­)
            }
        });
    </script>
</body>
</html>